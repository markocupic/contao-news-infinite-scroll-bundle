!function(n){ContaoNewsInfiniteScroll=function(o){let e=n.extend({newsContainer:".mod_newslist_infinite_scroll",scrollContainer:n(window),paginationNextLink:".pagination .next > a.next",paginationLastLink:".pagination .last > a.last",loadAllOnDomready:!1,loadMoreButton:!0,loadMoreButtonMarkup:'<div class="inf-scr-load-more-btn-container text-center"><button class="btn btn-primary w-100"><?= $GLOBALS["TL_LANG"]["MSC"]["infScrLoadMore"] ?></button></div>',anchorPoint:".mod_newslist_infinite_scroll",bottomPixels:100,fadeInTime:400,loadingInProcessContainer:'<div class="inf-scr-loading-in-process-container text-center"><i class="fa fa-5x fa-spinner fa-spin"></i>{{br}}{{br}}<?= $GLOBALS["TL_LANG"]["MSC"]["infScrLoadingInProcess"] ?>...</em></div>',onInitialize:function(n){},onXHRStart:function(n){},onXHRComplete:function(n,o){return n},onXHRFail:function(n){},onBeforeAppendCallback:function(n,o){},onAppendCallback:function(n,o){}},o||{}),t=this,r=null,a=null,l=null,s=0,c=[],d=0,f=0;t.blnHasError=!1,t.currentUrl="",t.urlIndex=0,t.response="",t.loadMoreBtn=null,t.xhr=null,this.getOption=function(n){return void 0!==e[n]&&e[n]};let u=function(){1!=s&&1!=d&&(t.blnHasError=!1,t.currentUrl=c[t.urlIndex],void 0!==t.currentUrl?t.xhr=n.ajax({url:t.currentUrl,beforeSend:function(){e.onXHRStart(t),n(r).attr("aria-busy","true"),s=1,""!=e.loadingInProcessContainer&&n(e.loadingInProcessContainer).addClass("inf-scr-loading-in-process-container").insertAfter(r).fadeIn(100)}}).done(function(n){t.blnHasError=!1,t.response=n,t.response=e.onXHRComplete(t.response,t,t.xhr),!1===t.blnHasError?(t.urlIndex++,setTimeout(function(){g()},1e3)):p()}).fail(function(){p()}).always(function(){setTimeout(function(){n(".inf-scr-loading-in-process-container").remove(),n(r).attr("aria-busy","false"),c.length==t.urlIndex&&(d=1,n(t.loadMoreBtn).length&&(t.loadMoreBtn.remove(),t.loadMoreBtn=null),void 0!==f&&clearInterval(f)),null!==t.loadMoreBtn&&t.loadMoreBtn.show(),s=0},1e3)}):(d=1,void 0!==f&&clearInterval(f)))},p=function(){s=0,e.onXHRFail(t,t.xhr)},g=function(){e.onBeforeAppendCallback(t,t.xhr),""!=t.response&&n(t.response).hide().appendTo(r).fadeIn(e.fadeInTime),e.onAppendCallback(t,t.xhr)};!function(){if(!0===e.onInitialize(t)&&void 0!==(r=n(e.newsContainer)[0])&&0!==n(e.newsContainer+" "+e.paginationNextLink).length){if(n(e.newsContainer+" "+e.paginationNextLink).length){let o=n(e.newsContainer+" "+e.paginationNextLink).first(),t=n(o).prop("href"),r="page_n(\\d*)=(\\d*)",a=new RegExp(r,"g"),l=a.exec(t);if(!l)return void console.error('News infinite scroll initialization aborted! Could not find pagination link with pattern "'+r+'".');let s=l[1],d=l[2],f=d;if(n(e.newsContainer+" "+e.paginationLastLink).length>0){let o=n(e.newsContainer+" "+e.paginationLastLink).first(),t=n(o).prop("href"),i=new RegExp(r,"g").exec(t);i&&(f=i[2])}for(i=d;i<=f;i++){let n=t.replace(a,"page_n"+s+"="+i);c.push(n)}}void 0!==(l=n(e.scrollContainer)[0])?(0==e.bottomPixels&&(e.bottomPixels=1),a=n(r),void 0!==n(e.anchorPoint)[0]&&(a=n(e.anchorPoint)[0]),!0===e.loadAllOnDomready?(u(),f=setInterval(u,3e3)):!0===e.loadMoreButton?(t.loadMoreBtn=n(e.loadMoreButtonMarkup),t.loadMoreBtn.insertAfter(r),t.loadMoreBtn.addClass("inf-scr-load-more-btn-container"),t.loadMoreBtn.click(function(o){n(this).hide(),u()})):n(l).on("scroll",function(){n(l).scrollTop()>n(a).offset().top+n(a).innerHeight()-n(l).height()-e.bottomPixels&&u()})):console.error("ContaoNewsInfiniteScroll aborted! Please select a valid scroll container.")}}()}}(jQuery);
